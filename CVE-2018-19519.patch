From 59516dac93b827af9656a7e7816d3acb3fd3d5c7 Mon Sep 17 00:00:00 2001
From: Arzhan Kinzhalin <arzhan.i.kinzhalin@intel.com>
Date: Thu, 6 Dec 2018 10:22:43 -0800
Subject: [PATCH] Fix CVE-2018-19519.

Initialize the first element of the buffer to '\0' as suggested by the
reporter.

Signed-off-by: Arzhan Kinzhalin <arzhan.i.kinzhalin@intel.com>
---
 print-hncp.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/print-hncp.c b/print-hncp.c
index 11a6a932..bb61a74e 100644
--- a/print-hncp.c
+++ b/print-hncp.c
@@ -206,6 +206,8 @@ print_prefix(netdissect_options *ndo, const u_char *prefix, u_int max_length)
     int plenbytes;
     char buf[sizeof("xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx::/128")];
 
+    buf[0] = '\0';
+
     if (prefix[0] >= 96 && max_length >= IPV4_MAPPED_HEADING_LEN + 1 &&
         is_ipv4_mapped_address(&prefix[1])) {
         struct in_addr addr;
-- 
2.19.2

